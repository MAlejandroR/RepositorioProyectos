# âœ… Pasos para listar carpetas de Google Drive en tu aplicaciÃ³n LaravelEste documento explica cÃ³mo permitir que usuarios con rol de `teacher` puedan autenticar con Google y ver una lista de carpetas en su Google Drive.---## 1. Crear el proyecto en Google CloudSigue estos pasos en [Google Cloud Console](https://console.cloud.google.com/):- Crea un nuevo proyecto.- Habilita la [Google Drive API](https://console.cloud.google.com/apis/library/drive.googleapis.com).- Crea credenciales **OAuth 2.0** para una aplicaciÃ³n web.- Configura las URLs de redirecciÃ³n (por ejemplo: `http://localhost:8000/callback` en desarrollo).MÃ¡s info: [DocumentaciÃ³n oficial de Google OAuth 2.0](https://developers.google.com/identity/protocols/oauth2)---## 2. Instalar la librerÃ­a de Google en Laravel```bashcomposer require google/apiclient:^2.0LibrerÃ­a oficial: googleapis/google-api-php-client```# 3. Autenticar al usuarioRedirigir a Google para login:```phpuse Google_Client;public function redirectToGoogle(){    $client = new Google_Client();    $client->setClientId(config('services.google.client_id'));    $client->setClientSecret(config('services.google.client_secret'));    $client->setRedirectUri(route('google.callback'));    $client->addScope(Google_Service_Drive::DRIVE_METADATA_READONLY);    return redirect($client->createAuthUrl());}```; Ruta de callback para guardar el token:```php public function handleGoogleCallback(){    $client = new Google_Client();    $client->setClientId(config('services.google.client_id'));    $client->setClientSecret(config('services.google.client_secret'));    $client->setRedirectUri(route('google.callback'));    $client->fetchAccessTokenWithAuthCode(request('code'));    session(['google_token' => $client->getAccessToken()]);    return redirect()->route('folders.list');} ```# 4. Listar las carpetas del usuario```php use Google_Service_Drive;public function listFolders(){    $client = new \Google_Client();    $client->setAccessToken(session('google_token'));    if ($client->isAccessTokenExpired()) {        return redirect()->route('google.redirect');    }    $service = new Google_Service_Drive($client);    $response = $service->files->listFiles([        'q' => "mimeType = 'application/vnd.google-apps.folder' and trashed = false",        'fields' => 'files(id, name)',    ]);    $folders = $response->getFiles();    foreach ($folders as $folder) {        echo $folder->getName() . '<br>';    }} ```; Consulta la documentaciÃ³n oficial de Google Drive API para mÃ¡s parÃ¡metros y ejemplos.ðŸ›¡ï¸ Control de acceso por rolAsegÃºrate de proteger esta funcionalidad solo para usuarios con el rol teacher. Por ejemplo:```php if (auth()->user()->role !== 'teacher') {    abort(403);}```